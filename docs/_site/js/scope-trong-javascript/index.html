<p><img src="https://i1.wp.com/beautyoncode.com/wp-content/uploads/2022/11/agriculture-gfa5e56941_1920.jpeg" alt="" /></p>

<p>Scope liên quan trực tiếp bởi Lexical Environment bởi scope liên quan đến phạm vi truy cập của biến.</p>

<p>Mời bạn ghé đọc <a href="https://beautyoncode.com/lexical-environment-trong-javascript/">bài viết Lexical Environment</a> trước nếu bạn chưa có dịp đọc nha.</p>

<p>Bài viết này sẽ tìm hiểu thêm về scope và các loại scope trong JavaScript.</p>

<h2 id="scope-là-gì">Scope là gì?</h2>
<p>Scope (tiếng Việt là “phạm vi”) là phạm vi được xác định nơi mà bạn có thể truy cập vào biến.</p>

<blockquote>
  <p>Scope determines the variables accessibility (visibility)</p>
</blockquote>

<h2 id="các-loại-scope-trong-javascript">Các loại scope trong JavaScript</h2>
<p>Có 3 loại scope trong JavaScript:</p>

<p>– Block Scope (có từ ES6)</p>

<p>– Function Scope hay Local Scope</p>

<p>– Global Scope</p>

<hr />

<p>Ở ES5, chỉ có hai scope là Function Scope và Global Scope</p>

<p>– Scope của function gọi là Function Scope</p>

<p>– Scope bên ngoài function gọi là Global Scope, tương ứng với khai báo biến với var</p>

<p>Tức là:</p>

<p>– trong function → biến thuộc Function Scope</p>

<p>– bên ngoài function → biến thuộc Global Scope</p>

<p>Ví dụ:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// a in global scope</span>
<span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">x</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// b in function x scope</span>
  <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 5</span>
<span class="nx">x</span><span class="p">()</span> <span class="c1">// 10</span>
</code></pre></div></div>

<p>Hình bên dưới minh họa hai loại scope này:</p>

<p><img src="https://i2.wp.com/beautyoncode.com/wp-content/uploads/2022/11/scope-es5.png" alt="" /></p>

<p>Chiếc khung màu đen thể hiện phạm vi của từng loại scope.</p>

<p>– Khung bọc màu tím là phạm vi của hàm x, hay function x scope.</p>

<p>– Khung bọc màu xanh là phạm vi của global, hay global scope.</p>

<hr />

<p>Ở ES6, JavaScript giới thiệu thêm hai cách khai báo biến với let, const (<a href="https://beautyoncode.com/khai-bao-bien-voi-var-let-va-const-trong-javascript/">đọc thêm về var, let, const mình ở đây</a>) đi kèm đó là một loại scope mới – block scope.</p>

<p>Khi bạn khai báo một biến với let, const trong một block, được hiểu là bọc trong một cặp {} , thì biến này nằm trong block scope đó.</p>

<p>Ví dụ:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">x</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">c</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">c</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello from d</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">x</span><span class="p">();</span>
</code></pre></div></div>

<p>Thử đặt một breakpoint và quan sát trên debugger:</p>

<p><img src="https://i2.wp.com/beautyoncode.com/wp-content/uploads/2022/11/check-scope.png" alt="" /></p>

<p>Ở Global có a là 5, Local có c là 15, Block có d là 0 tương ứng với 3 scopes mình đã đề cập.</p>

<p>Vậy b đang ở đâu? Bạn có thấy b đang thuộc một nơi gọi là Script ?</p>

<p>Thực ra thì b vẫn đang thuộc global scope. Chỉ là vì nó được khai báo với let và được nằm trong một vùng nhớ riêng gọi là <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let#temporal_dead_zone_tdz">Temporary Dead Zone (TDZ)</a> nên được mô tả khác trên debugger ở một tab gọi là Script. (đọc thêm ở <a href="https://beautyoncode.com/hoisting-trong-javascript/">blog này</a>)</p>

<p>Bạn có thể chứng minh được b vẫn thuộc global scope vì tại dòng được debug, vẫn có thể truy cập vào b được. Tuy nhiên bạn không thể truy cập vào b từ window , ví dụ window.b</p>

<p>Hình bên dưới minh họa ba loại scope ở ví dụ trên:</p>

<p><img src="https://i2.wp.com/beautyoncode.com/wp-content/uploads/2022/11/scope-js-now.png" alt="" /></p>
