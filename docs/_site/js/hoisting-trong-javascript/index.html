<p><img src="https://i0.wp.com/beautyoncode.com/wp-content/uploads/2022/09/thread-246742_1280.jpeg?w=1280&amp;ssl=1" alt="" /></p>

<p>Điều khiến JavaScript khó hiểu với những người mới hay chuyển từ ngôn ngữ khác qua chính là JavaScript cho phép sử dụng biến và hàm ngay cả trước cả khi bạn khai báo chúng.</p>

<p>Ví dụ ở đoạn code này:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span>
<span class="mi">2</span><span class="p">.</span> <span class="nx">aFunction</span><span class="p">()</span>
<span class="mi">3</span><span class="p">.</span> 
<span class="mi">4</span><span class="p">.</span> <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="mi">5</span><span class="p">.</span> <span class="kd">function</span> <span class="nx">aFunction</span><span class="p">()</span> <span class="p">{</span>
<span class="mi">6</span><span class="p">.</span> 	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello</span><span class="dl">"</span><span class="p">)</span>
<span class="mi">7</span><span class="p">.</span> <span class="p">}</span>
</code></pre></div></div>

<p>Chương trình khi chạy không báo lỗi gì và kết quả in ra ở Console là:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kc">undefined</span>
<span class="nx">Hello</span>
</code></pre></div></div>
<p>Lưu ý ở đây mình dùng <code class="language-plaintext highlighter-rouge">var</code> , nếu sử dụng <code class="language-plaintext highlighter-rouge">let</code> hay <code class="language-plaintext highlighter-rouge">const</code> thì sẽ bị lỗi <code class="language-plaintext highlighter-rouge">Uncaught ReferenceError: x is not defined</code> vì với <code class="language-plaintext highlighter-rouge">let</code> hay <code class="language-plaintext highlighter-rouge">const</code> của ES6 thì chỉ sau khi bạn khai báo mới sử dụng được chúng.</p>

<p>Vậy điều gì đã khiến bạn có thể truy cập vào các biến và hàm ngay cả khi chúng chưa được khai báo?</p>

<p><strong>Chính là cơ chế Hoisting trong JavaScript.</strong></p>

<p>Vậy cụ thể thì <code class="language-plaintext highlighter-rouge">hoisting</code> là như thế nào?</p>

<p>Bạn có nhớ hai giai đoạn của một <code class="language-plaintext highlighter-rouge">“Execution Context”</code> là <code class="language-plaintext highlighter-rouge">Memory Creation</code> và <code class="language-plaintext highlighter-rouge">Code Execution</code> đã được giới thiệu trong bài <a href="https://beautyoncode.com/dieu-gi-xay-ra-khi-chay-mot-chuong-trinh-javascript/">“Điều gì xảy ra khi chạy một chương trình JavaScript”</a> không?</p>

<p><strong>Hoisting</strong> trong JavaScript được thực hiện trong giai đoạn cấp phát bộ nhớ – <strong>Memory Creation</strong>. Các biến và hàm sẽ được cấp bộ nhớ trước khi code được thực thi, biến được cấp bộ nhớ với giá trị <code class="language-plaintext highlighter-rouge">undefined</code> , còn hàm thì sẽ được cấp bộ nhớ cho toàn bộ nội dung bên trong hàm <code class="language-plaintext highlighter-rouge">f aFunction()</code>.</p>

<p>Vì thế, bước vào giai đoạn thực thi <strong>Code Execution</strong>, thì các giá trị này đã có sẵn để sử dụng, nên gọi các hàm và biến này đã được <code class="language-plaintext highlighter-rouge">hoist</code> lên trước khi code được thực thi.</p>

<hr />

<p>Bạn có thể kiểm tra trực tiếp trên <strong>devTools</strong> bằng cách đặt một breakpoint ngay tại dòng số 4, ngay trước khi code của biến và hàm được khai báo.</p>

<p>Khi chương trình chạy, gặp <strong>breakpoint</strong> dừng lại, hãy kiểm tra tab <strong>Global</strong> và tìm <code class="language-plaintext highlighter-rouge">a</code> , <code class="language-plaintext highlighter-rouge">aFunction</code> , tại đây tìm thấy biến <code class="language-plaintext highlighter-rouge">a</code> và hàm <code class="language-plaintext highlighter-rouge">aFunction</code> đã được cấp phát bộ nhớ và sẵn sàng để sử dụng.</p>

<p><img src="https://i0.wp.com/beautyoncode.com/wp-content/uploads/2022/09/hoisting.png" alt="" /></p>

<p>Một lưu ý ở đây, nếu aFunction được khai báo ở dạng biểu thức dưới tên một biến</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">aFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
</code></pre></div></div>

<p>thì <code class="language-plaintext highlighter-rouge">aFunction</code> sẽ có giá trị ban đầu là <code class="language-plaintext highlighter-rouge">undefined</code> như với một biến bình thường, và chương trình này sẽ báo lỗi.</p>

<p><strong>Hoisting</strong> trong JavaScript sẽ dễ gây hiểu nhầm nếu bạn không hiểu về JavaScript Engine nên bạn cần tìm hiểu cơ chế này để dễ debug chương trình của mình nhé.</p>

<p>Thêm nữa, ở phiên bản ES6, cung cấp let và const để yêu cầu bạn chỉ sử dụng biến sau khi đã khai báo chúng nên sẽ tránh được các sử dụng không mong đợi như trên.</p>

<p>Vì thế, bạn nên ưu tiên sử dụng let và const thay thế cho var.</p>

<p>(<a href="https://www.youtube.com/watch?v=pN6jk0uUrD8&amp;list=PLlasXeu85E9cQ32gLCvAvr9vNaUccPVNP">Ref series Namaste JavaScript</a>)</p>
